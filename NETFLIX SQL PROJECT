--NETFLIX SQL PROJECT

--1) COUNT OF MOVIES
--SELECT 
--COUNT (*) AS TOTAL_COUNT
--FROM NETFLIX
--WHERE TYPE = 'MOVIE'

--2) DISTINCT VALUES IN THE TYPE COLUMN
--SELECT 
-- DISTINCT TYPE
--FROM NETFLIX


--3) COUNT THE NUMBER OF MOVIES VS TV SHOWS
--SELECT 
-- DISTINCT TYPE,
-- COUNT (*) AS TOTAL_COUNT
-- FROM NETFLIX
-- GROUP BY TYPE

--4)FIND THE MOST COMMON RATING FOR MOVIES AND TV SHOWS
--SELECT TYPE, RATING, COUNT(RATING) AS RATING_COUNT
--FROM Netflix
--WHERE RATING = 'TV-MA' --OR TYPE = 'TV SHOW'
--GROUP BY  TYPE, RATING
--ORDER BY 3 DESC


--5) LIST ALL MOVIES RELEASED IN A SPECIFIC YEAR(E.G. 2020)
--SELECT *
--FROM NETFLIX
--WHERE 
--TYPE = 'Movie'
--AND
-- RELEASE_YEAR= 2020

--6) FIND THE TOP 5 COUNTRIES WITH THE MOST COTENT ON NETFLIX
--SELECT TOP 5 COUNTRY, COUNT(COUNTRY) AS COUNTCOUNT
--FROM Netflix_Staging
--GROUP BY COUNTRY
--ORDER BY COUNTCOUNT DESC
	
--7) IDENTIFY THE LONGEST MOVIE OR TV SHOWS DURATION
--select TYPE, DURATION from netflix

--8) FIND CONTENT ADDED IN THE LAST 5 YEARS
--SELECT *
--FROM NETFLIX
--WHERE YEAR(GETDATE())- YEAR(DATE_ADDED) <= 5 

--9) FIND ALL THE MOVIES/TV SHOWS IS 5 SEASONS
--SELECT *
--FROM NETFLIX_STAGING
--WHERE DURATION = '5 SEASONS'

--10) FIND ALL THE MOVIES/TV SHOWS BY DIRECTOR RAJIV CHILAKA
--SELECT *
--FROM NETFLIX_STAGING
--WHERE DIRECTOR = 'RAJIV CHILAKA'

--11) COUNT THE NUMBER OF CONTENT ITEMS IN EACH GENRE
--SELECT LISTED_IN, COUNT(LISTED_IN) AS GENRE_COUNT
--FROM NETFLIX_STAGING
--GROUP BY LISTED_IN
--ORDER BY 2 DESC

--12) FIND THE AVERAGE RELEASE YEAR FOR CONTENT PRODUCED IN A SPECIFIC COUNTRY
--SELECT TYPE, ROUND( AVG(RELEASE_YEAR), 0) AS YEAR_AVG
--FROM NETFLIX_STAGING
--WHERE COUNTRY = 'INDIA'
--GROUP BY TYPE

----13) LIST ALL MOVIES THAT ARE DOCUMENTARY
--SELECT *
--FROM NETFLIX_STAGING
--WHERE TYPE = 'MOVIE'
--  AND
--   LISTED_IN = 'DOCUMENTARIES'

--14) FIND ALL CONTENT WITHOUT A DIRECTOR
--SELECT *
--FROM NETFLIX_STAGING
--WHERE DIRECTOR IS NULL

--15) FIND HOW MANY MOVIES ACTOR SALMAN KAHN APPEARED IN THE LAST 10 YEARS
--SELECT *
--FROM NETFLIX
--WHERE YEAR(GETDATE())- YEAR(DATE_ADDED) <= 10
--AND TYPE = 'MOVIE'
--AND CAST LIKE '%SALMAN KHAN%'

--16) CATEGORIZE THE CONTENT BASED ON THE PRESENCE OF THE KEYWORDS 'KILL' AND 'VIOLENCE' IN THE DESCRIPTION FIELD. LABEL CONTENT 
--    CONTAINING THESE KEYWORDS AS BAD AND ALL OTHER CONTENTS AS GOOD.

--SELECT *
--FROM NETFLIX_STAGING
--ALTER TABLE NETFLIX_STAGING
--ADD KEYWORDS VARCHAR(50)

--UPDATE NETFLIX_STAGING
--SET KEYWORDS = 'BAD'
-- WHERE DESCRIPTION LIKE '%KILL%' OR
-- DESCRIPTION LIKE '%VIOLENCE%'

--UPDATE NETFLIX_STAGING
--SET KEYWORDS = 'GOOD'
-- WHERE DESCRIPTION NOT LIKE '%KILL%'  OR
-- DESCRIPTION NOT LIKE '%VIOLENCE%'

--17) COUNT HOW MANY ITEMS FALL INTO THE GOOD AND BAD CATEGORY
--SELECT DISTINCT KEYWORDS, COUNT(KEYWORDS) AS KEYWORD_COUNT
--FROM NETFLIX_STAGING
--GROUP BY KEYWORDS
